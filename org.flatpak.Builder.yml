app-id: org.flatpak.Builder
runtime: org.freedesktop.Sdk
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
command: flatpak-builder-wrapper
separate-locales: false
finish-args:
  - --require-version=1.0.0
  - --allow=devel
  - --talk-name=org.freedesktop.Flatpak
  - --share=ipc
  - --filesystem=host
  - --share=network
  - --filesystem=~/.local/share/flatpak
  - --filesystem=/var/lib/flatpak
build-options:
  env:
    BASH_COMPLETIONSDIR: /app/share/bash-completion/completions
    MOUNT_FUSE_PATH: ../tmp/
    V: '1'
cleanup:
  - '*.la'
  - '*.a'
modules:
  - name: wrapper
    buildsystem: simple
    build-commands:
      - ls -l
      - install -m a+rx flatpak-builder-wrapper.sh /app/bin/flatpak-builder-wrapper
    sources:
      - type: script
        dest-filename: flatpak-builder-wrapper.sh
        commands:
          - export FLATPAK_USER_DIR=$HOME/.local/share/flatpak
          - exec flatpak-builder "$@"
